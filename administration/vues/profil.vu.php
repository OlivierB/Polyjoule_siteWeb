<!--/**********Page de gestion du profil**********/--><?php $actions = array(1,2,3,4,5,6); // Tableau des actions possibles/*	Action 1 : modifier pseudo	Action 2 : modifier mot de passe	Action 3 : modifier email	Action 4 : Traitement modification pseudo	Action 5 : Traitement modification mot de passe	Action 6 : traitement modification email	Default : Affichage du profil*/if(isset($_GET['action']) && in_array($_GET['action'],$actions)){	$action = securite($_GET['action']);	if ($action==1) { //modifier pseudo		?>			<div class="contenu" style="text-align:center;">				<div style="height:50px;">					<div style="float : left;font-size : 120%;font-weight:bold;">						<div style="float:right; margin-top:10px;margin-left:10px;">							Modification du pseudo						</div>					</div>					<div style="height:50px;width:300px;float:right;">						<a href="" class="save"><img src="ressources/design/style1/images/save.png" alt="save_profil">Sauver</a>						<a href="" class="validate"><img src="ressources/design/style1/images/validate.png" alt="apply_profil">Appliquer</a>						<a href="index.php?page=profil&message=procedureAnnulee" class="cancel"><img src="ressources/design/style1/images/cancel.png" alt="cancel_profil">Annuler</a>					</div>				</div>				<div style="background-color : #f0f0ee;margin : 10px 12px 20px 13px;border : 1px solid #cccccc;text-align:left; padding-left : 20px;">					<strong>Information</strong> : Vous serez déconnecté une fois la procédure achevée si tout s'est bien passé.				</div>				<div style="background-color : #f0f0ee;margin : 10px 12px 20px 13px;border : 1px solid #cccccc;text-align:left; padding-left : 20px;">					<form method="post" action="index.php?page=profil&action=4">						<p>							<label for="pseudo" style="float : left;"><strong>Pseudo</strong> :</label>							<input type="text" style="margin-left:10px;" size="20" value="<?php echo $_SESSION['pseudo_membre']; ?>" name="pseudo"/> <br/><br/>						</p>						<input type="submit" value="Envoyer !" />					</form>				</div>			</div>		<?php	} else if ($action==2) { //modifier mot de passe		?>			<div class="contenu" style="text-align:center;">				<div style="height:50px;">					<div style="float : left;font-size : 120%;font-weight:bold;">						<div style="float:right; margin-top:10px;margin-left:10px;">							Modification du mot de passe						</div>					</div>					<div style="height:50px;width:300px;float:right;">						<a href="" class="save"><img src="ressources/design/style1/images/save.png" alt="save_profil">Sauver</a>						<a href="" class="validate"><img src="ressources/design/style1/images/validate.png" alt="apply_profil">Appliquer</a>						<a href="index.php?page=profil&message=procedureAnnulee" class="cancel"><img src="ressources/design/style1/images/cancel.png" alt="cancel_profil">Annuler</a>					</div>				</div>				<div style="background-color : #f0f0ee;margin : 10px 12px 20px 13px;border : 1px solid #cccccc;text-align:left; padding-left : 20px;">					<strong>Information</strong> : Vous serez déconnecté une fois la procédure achevée si tout s'est bien passé.				</div>				<div style="background-color : #f0f0ee;margin : 10px 12px 20px 13px;border : 1px solid #cccccc;text-align:left; padding-left : 20px;">					<form method="post" action="index.php?page=profil&action=5">						<p>							<table>								<tr>									<td>										<label for="ancien" style="float : left;"><strong>Mot de passe actuel</strong> :</label>									</td>									<td>										<input type="password" style="margin-left:10px;" size="20" value="" name="ancien"/>									</td>								</tr>								<tr>									<td>										<label for="mdp" style="float : left;"><strong>Mot de passe</strong> :</label>									</td>									<td>										<input type="password" style="margin-left:10px;" size="20" value="" name="mdp"/>									</td>								</tr>								<tr>									<td>										<label for="mdp2" style="float : left;"><strong>Mot de passe</strong> (confirmation) :</label>									</td>									<td>										<input type="password" style="margin-left:10px;" size="20" value="" name="mdp2"/>									</td>								</tr>							</table>						</p>						<input type="submit" value="Envoyer !" />					</form>				</div>			</div>		<?php	} else if ($action==3) { //modifier email		?>			<div class="contenu" style="text-align:center;">				<div style="height:50px;">					<div style="float : left;font-size : 120%;font-weight:bold;">						<div style="float:right; margin-top:10px;margin-left:10px;">							Modification de l'adresse mail						</div>					</div>					<div style="height:50px;width:300px;float:right;">						<a href="" class="save"><img src="ressources/design/style1/images/save.png" alt="save_profil">Sauver</a>						<a href="" class="validate"><img src="ressources/design/style1/images/validate.png" alt="apply_profil">Appliquer</a>						<a href="index.php?page=profil&message=procedureAnnulee" class="cancel"><img src="ressources/design/style1/images/cancel.png" alt="cancel_profil">Annuler</a>					</div>				</div>				<div style="background-color : #f0f0ee;margin : 10px 12px 20px 13px;border : 1px solid #cccccc;text-align:left; padding-left : 20px;">					<form method="post" action="index.php?page=profil&action=6">						<p>							<table>								<tr>									<td>										<label for="mail" style="float : left;"><strong>Nouvel E-mail</strong> :</label>									</td>									<td>										<input type="email" style="margin-left:10px;" size="20" value="" name="mail"/>									</td>								</tr>								<tr>									<td>										<label for="mail2" style="float : left;"><strong>Nouvel E-mail</strong> (confirmation) :</label>									</td>									<td>										<input type="email" style="margin-left:10px;" size="20" value="" name="mail2"/>									</td>								</tr>							</table>						</p>						<input type="submit" value="Envoyer !" />					</form>				</div>			</div>		<?php	} else if ($action==4) { //Traitement modification pseudo		if (isset($_POST['pseudo'])) {			MAJPseudo(securite($_POST['pseudo']));		} else {			header("Location: index.php?page=profil&message=erreurFormulaire");		}	} else if ($action==5) { //Traitement modification mot de passe		if (isset($_POST['ancien']) && isset($_POST['mdp']) && isset($_POST['mdp2'])) {			MAJMotDePasse(sha1(securite($_POST['ancien'])),sha1(securite($_POST['mdp'])),sha1(securite($_POST['mdp2'])));		} else {			header("Location: index.php?page=profil&message=erreurFormulaire");		}	} else if ($action==6) { //traitement modification email		if (isset($_POST['mail']) && isset($_POST['mail2'])) {			MAJMail(securite($_POST['mail']),securite($_POST['mail2']));		} else {			header("Location: index.php?page=profil&message=erreurFormulaire");		}	} else { //affichage du profil		header("Location: index.php?page=profil");	}} else {	?>		<div class="contenu" style="text-align:center;">			<h2>Gestion du profil</h2>			<?php			if (isset($_GET['message'])) { /* si il y a un message*/				?>					<div style="background-color : #f0f0ee;margin : 10px 12px 20px 13px;border : 1px solid #cccccc;text-align:left; padding-left : 20px;">						<strong>Message :</strong>				<?php				echo getMessage(securite($_GET['message']));				?>					</div>				<?php			}			affichageProfil();			?>		</div>	<?php}?>